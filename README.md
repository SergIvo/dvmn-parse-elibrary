# Парсер онлайн-библиотеки

## О проекте

Проект соджержит два скрипта. Один из них предназначен для скачивания книг из раздела "Научная фантастика" онлайн-библиотеки [https://tululu.org/l55/](https://tululu.org/l55/). 
Это приложение запускается из командной строки и скачивает книги с указанных страниц раздела, либо все книги из раздела. Интервал страниц указывается при запуске
в качестве аргументов командной строки при запуске приложения. Также как аргументы могут быть указаны папка, в которой будут сохранены результаты парсинга и отдельная 
папка для файла с информацией о скачанных книгах. Скачивание текстов и обложек книг производится по умолчанию и может быть отключено соответствующими аргументами при запуске приложения.

Второй скрипт генерирует статический сайт из данных, собранных при помощи первого скрипта. Демо-версию сайта можно посмотреть на [GitHub Pages](https://sergivo.github.io/dvmn-parse-elibrary/pages/index1.html)

Проект создан в учебных целях в рамках курса по веб-разработке на [dvmn.org](https://dvmn.org/)

## Установка

1. Скачайте код проекта с GitHub с помощью команды `git clone`:
```commandline
git clone https://github.com/SergIvo/dvmn-parse-elibrary
```
2. С помощью пакета [venv](https://docs.python.org/3/library/venv.html) создайте виртуальное окружение (это позволит избежать конфликтов Python-библиотек с разными версиями):
```commandline
python -m venv venv
```
Активируйте виртуальное окружение:
```commandline
source venv/bin/activate
```
Затем установите необходимые для запуска приложения библиотеки из файла "requirements.txt" с помощью команды `pip`:
```commandline
pip install -r requirements.txt
```

## Запуск срипта для скачивания данных из библиотеки 

Для запуска приложения введите в консоли следующую команду:
```commandline
python parse_tululu_category.py
```
В этом случае приложение запустится без аргументов и по умолчанию будет скачивать книги в разделе "Научная фантастика" с первой страницы по последнюю.
Чтобы скачать книги в другом интервале страниц, укажите начальную и конечную страницы следующими ключевыми словами: 
```
--start_page - первая страница;
--end_page - конечная страница;
```
Пример:
```commandline
python parse_tululu_category.py --start_page 2 --end_page 4
```
В этом случае приложение скачает книги начиная со страницы [https://tululu.org/l55/2/](https://tululu.org/l55/2/) и заканчивая страницей [https://tululu.org/l55/4/](https://tululu.org/l55/4/).
Если начальная страница не указана, скачивание начнется с первой страницы. Если не указана конечная страница, скачивание будет продолжаться до последней страницы в разделе.

По умолчанию скачиваются и тексты, и обложки книг. Чтобы не скачивать тексты либо обложки книги, запустите приложение с соответствующими ключевыми словами:
```
--skip_imgs - пропустить скачивание обложек книг;
--skip_txt - пропустить скачивание текстов книг;
```
Пример:
```commandline
python parse_tululu_category.py --start_page 2 --end_page 4 --skip_imgs True --skip_txt True 
```
Если у книги с одним из ID из интервала отсутствует описание или ссылка на текст, приложение выведет 
в консоль соответствующее сообщение. Пример вывода:
```commandline
(venv) [Sergey@localhost parsing_elib]$ python parse_tululu_category.py --start_page 2 --end_page 3 --skip_imgs True
Текст книги по ссылке https://tululu.org/b11477/ не доступен.
Текст книги по ссылке https://tululu.org/b12674/ не доступен.
Текст книги по ссылке https://tululu.org/b14480/ не доступен.
```
По умолчанию тексты книг сохраняются в папку `books` в основной папке приложения. Обложки книг, если они есть, по умолчанию сохраняются в папку `images`.
Файл `books.json`, содержащий информацию о скачанных книгах, по умолчанию также сохраняется в основной папке приложения. Чтобы папки `books` и `images`, а также .json-файл
создавались не в основной папке приложения, необходимо передать путь к нужной папке для сохранения с ключевым словом:
```
--dest_folder - путь к папке, в которой будут сохранены папки books, images и books.json 
```
Дополнительно можно указать альтернативный путь к папке, в которой будет сохранен файл `books.json`. Пример:
```commandline
python parse_tululu_category.py --start_page 2 --end_page 4 --dest_folder some/directory --json_path json/directory 
```
## Запуск срипта для создания статического сайта
*Важно:* чтобы приложение смогло сгенерировать страницы сайта, нужно сперва скачать данные из библиотеки tululu.org. Как это сделать, описано выше.
Обратите внимание на то, что при скачивании данных необходимо указать `media` в качестве названия папки, в которую будут сохранены данные. Пример:
```commandline
python parse_tululu_category.py --dest_folder media 
```
Параметры `--skip_imgs` и `--skip_txt` в этом случае указывать нельзя, иначе часть данных, необходимых для создания сайта, не будет скачана.

После того, как необходимые данные загружены, запустите приложение следующей командой:
```commandline
python render_website.py
```
После этого приложене создаст папку `pages` в папке проекта, в которой будут сохранены сгенерированные страницы сайта. Сайт можно сразу же открыть по ссылке
[127.0.0.1:5500/pages/index1.html](http://127.0.0.1:5500/pages/index1.html)